package resolver

import (
	"context"
	"picodns/internal/cache"
	"testing"
)

func BenchmarkResolveFromCache(b *testing.B) {
	c := cache.New(10000, nil)
	cr := NewCached(c, nil)

	// A query for example.com
	req := []byte{0x00, 0x01, 0x01, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x03, 0x77, 0x77, 0x77, 0x07, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65,
		0x03, 0x63, 0x6f, 0x6d, 0x00, 0x00, 0x01, 0x00, 0x01}

	ctx := context.Background()
	b.ResetTimer()
	for i := 0; i < b.N; i++ {
		cr.ResolveFromCache(ctx, req)
	}
}
